<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FX Shield エントリー判定</title>
    <!-- デザイン用のライブラリ（Tailwind CSS）を読み込み -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 全体の見た目：目に優しい淡い色合い */
        body {
            background-color: #fcfdfe;
            color: #334155;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
        }
        /* カードのデザイン：角を丸くして柔らかい印象に */
        .step-card {
            border-radius: 1.25rem;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }
        /* ステップごとの淡いパステルカラー */
        .bg-step1 { background-color: #f0f7ff; } /* ブルー：環境認識 */
        .bg-step2 { background-color: #fff5f5; } /* ピンク：水平線 */
        .bg-step3 { background-color: #f0fdf4; } /* グリーン：移動平均線 */
        
        /* 本来のチェックボックスは見えないように隠す */
        input[type="checkbox"] {
            display: none;
        }
        /* 自作のチェックアイコン */
        .check-icon {
            width: 26px;
            height: 26px;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s;
        }
        /* チェックされた時のカードの変化 */
        input[type="checkbox"]:checked + .step-card {
            background-color: #ffffff;
            border-color: #e2e8f0;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
        }
        input[type="checkbox"]:checked + .step-card .check-icon {
            background-color: #475569;
            border-color: #475569;
        }
        input[type="checkbox"]:checked + .step-card .check-icon::after {
            content: '✓';
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
    </style>
</head>
<body class="p-4 pb-24">

    <div class="max-w-md mx-auto">
        <!-- ヘッダーエリア -->
        <header class="mb-8 text-center">
            <h1 class="text-xl font-black tracking-tighter text-slate-800">FX SHIELD</h1>
            <p class="text-[10px] text-slate-400 font-bold tracking-[0.2em] uppercase">エントリー判定シート</p>
            <div class="h-1 w-10 bg-slate-800 mx-auto mt-2"></div>
        </header>

        <!-- 進捗メーター：生徒のモチベーションアップ用 -->
        <div class="mb-8 bg-white p-4 rounded-2xl shadow-sm border border-slate-100">
            <div class="flex justify-between items-end mb-2">
                <span class="text-[10px] font-black text-slate-400 uppercase">分析の進捗</span>
                <span id="progressText" class="text-sm font-black text-slate-800">0%</span>
            </div>
            <div class="h-2 w-full bg-slate-100 rounded-full overflow-hidden">
                <div id="progressBar" class="h-full bg-slate-800 transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>

        <form id="sheetForm">
            <!-- Step 1: 4種の神器（ダウ・MTF） -->
            <div class="mb-8">
                <div class="flex items-center gap-2 mb-4">
                    <span class="text-[10px] font-black bg-blue-500 text-white px-2 py-0.5 rounded">STEP 01</span>
                    <h2 class="text-sm font-bold text-slate-700">環境認識（ダウ・MTF）</h2>
                </div>
                
                <label class="block mb-3 cursor-pointer">
                    <input type="checkbox" name="step" data-label="日足・4Hの方向一致">
                    <div class="step-card bg-step1 p-4 flex gap-4 items-start">
                        <div class="check-icon mt-0.5"></div>
                        <div>
                            <p class="text-sm font-bold text-slate-800">日足・4時間足の方向は？</p>
                            <p class="text-[11px] text-slate-500 mt-1 leading-relaxed">狙う方向に逆らっていないか？（上目線なのにショートしようとしてない？）</p>
                        </div>
                    </div>
                </label>

                <label class="block cursor-pointer">
                    <input type="checkbox" name="step" data-label="現在地の把握（収束）">
                    <div class="step-card bg-step1 p-4 flex gap-4 items-start">
                        <div class="check-icon mt-0.5"></div>
                        <div>
                            <p class="text-sm font-bold text-slate-800">現在の相場の「現在地」は？</p>
                            <p class="text-[11px] text-slate-500 mt-1 leading-relaxed">伸びきった先（乖離）ではなく、波の始まり（収束）を探せているか？</p>
                        </div>
                    </div>
                </label>
            </div>

            <!-- Step 2: 4種の神器（水平線） -->
            <div class="mb-8">
                <div class="flex items-center gap-2 mb-4">
                    <span class="text-[10px] font-black bg-rose-500 text-white px-2 py-0.5 rounded">STEP 02</span>
                    <h2 class="text-sm font-bold text-slate-700">壁の確認（水平線）</h2>
                </div>

                <label class="block cursor-pointer">
                    <input type="checkbox" name="step" data-label="壁の有無・スペース確認">
                    <div class="step-card bg-step2 p-4 flex gap-4 items-start">
                        <div class="check-icon mt-0.5"></div>
                        <div>
                            <p class="text-sm font-bold text-slate-800">目の前に「強い壁」はないか？</p>
                            <p class="text-[11px] text-slate-500 mt-1 leading-relaxed">利確目標までのスペースはあるか？近くに日足・4Hの水平線がないか？</p>
                        </div>
                    </div>
                </label>
            </div>

            <!-- Step 3: 4種の神器（移動平均線） -->
            <div class="mb-10">
                <div class="flex items-center gap-2 mb-4">
                    <span class="text-[10px] font-black bg-emerald-500 text-white px-2 py-0.5 rounded">STEP 03</span>
                    <h2 class="text-sm font-bold text-slate-700">引き金（移動平均線）</h2>
                </div>

                <label class="block mb-3 cursor-pointer">
                    <input type="checkbox" name="step" data-label="MAの収束（凝縮）">
                    <div class="step-card bg-step3 p-4 flex gap-4 items-start">
                        <div class="check-icon mt-0.5"></div>
                        <div>
                            <p class="text-sm font-bold text-slate-800">MAは「ギュッ」と凝縮しているか？</p>
                            <p class="text-[11px] text-slate-500 mt-1 leading-relaxed">短期・中期・長期が1点に集まり、エネルギーが溜まっているか？</p>
                        </div>
                    </div>
                </label>

                <label class="block cursor-pointer">
                    <input type="checkbox" name="step" data-label="拡散の初動確認">
                    <div class="step-card bg-step3 p-4 flex gap-4 items-start">
                        <div class="check-icon mt-0.5"></div>
                        <div>
                            <p class="text-sm font-bold text-slate-800">「拡散」の第一歩が出たか？</p>
                            <p class="text-[11px] text-slate-500 mt-1 leading-relaxed">収束からMAが開き始めた「初動」を捉えられているか？</p>
                        </div>
                    </div>
                </label>
            </div>
        </form>

        <!-- 操作エリア（画面下部に固定） -->
        <div class="fixed bottom-0 left-0 right-0 p-4 bg-white/80 backdrop-blur-md border-t border-slate-100">
            <button onclick="copyToClipboard()" class="w-full max-w-md mx-auto block bg-slate-800 text-white py-4 rounded-2xl font-bold text-sm shadow-xl active:scale-95 transition-all">
                判定結果をコピーしてLINEへ送る
            </button>
        </div>
    </div>

    <!-- コピー完了通知（トースト） -->
    <div id="toast" class="fixed top-10 left-1/2 -translate-x-1/2 bg-slate-800 text-white text-xs px-6 py-3 rounded-full opacity-0 transition-opacity pointer-events-none z-50">
        コピーしました！LINEに貼り付けてください
    </div>

    <script>
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        const bar = document.getElementById('progressBar');
        const textPercent = document.getElementById('progressText');

        // チェックが入るたびに進捗を更新する
        checkboxes.forEach(cb => {
            cb.addEventListener('change', () => {
                const checkedCount = document.querySelectorAll('input:checked').length;
                const totalCount = checkboxes.length;
                const percent = Math.round((checkedCount / totalCount) * 100);
                bar.style.width = percent + '%';
                textPercent.innerText = percent + '%';
            });
        });

        // スマホでもPCでも確実にコピーするための関数
        function copyToClipboard() {
            const checked = Array.from(document.querySelectorAll('input:checked')).map(c => '✅ ' + c.getAttribute('data-label'));
            const unchecked = Array.from(document.querySelectorAll('input:not(:checked)')).map(c => '❌ ' + c.getAttribute('data-label'));
            
            // LINEで送る際の文章を組み立て
            let resultText = "【FX Shield 判定報告】\n";
            resultText += "------------------\n";
            resultText += checked.length > 0 ? checked.join('\n') + '\n' : "（チェック済み項目なし）\n";
            if(unchecked.length > 0) {
                resultText += "\n【未達項目】\n" + unchecked.join('\n') + '\n';
            }
            resultText += "------------------\n";
            resultText += "先生、添削をお願いします！";

            // 一時的な入力エリアを作ってコピーを実行
            const textArea = document.createElement("textarea");
            textArea.value = resultText;
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            textArea.style.top = "0";
            document.body.appendChild(textArea);
            
            textArea.focus();
            textArea.select();
            
            let success = false;
            try {
                success = document.execCommand('copy');
            } catch (err) {
                console.error('コピー失敗', err);
            }

            document.body.removeChild(textArea);

            if (success) {
                const toast = document.getElementById('toast');
                toast.style.opacity = '1';
                setTimeout(() => { toast.style.opacity = '0'; }, 2000);
            } else {
                alert("コピーに失敗しました。お手数ですが手動でコピーしてください。");
            }
        }
    </script>
</body>
</html>

